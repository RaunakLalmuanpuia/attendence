import{n as h,G as L,o as d,c as _,w as n,a as e,u as f,g as t,t as i,r as A,i as m,R as B,k as j,h as q,e as D,f as $,F as C,q as z,d as Q,s as I,O as F}from"./app-B6ljmE4m.js";import{_ as R,Q as T,b as w,c as M,a as Y}from"./MainLayout-Dp50SWY5.js";import{Q as E}from"./QChip-D021voJ6.js";import{Q as H}from"./QLayout-CQJIOMGO.js";import{d as y}from"./date-CGOT6K0H.js";import{u as G}from"./use-quasar-DJymb8OE.js";import{$ as K,A as U,S as W,E as J}from"./index.es-DtmFnyNK.js";import{u as X}from"./utils-DPnJAvhQ.js";import{_ as Z}from"./KaiCalendar-6W7IFLer.js";import"./selection-CBxV_n-G.js";import"./FooterComponent-BOyJhOv3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QDate-n6V6MZ0s.js";import"./use-cache-hsIl6Ivw.js";const tt={style:{"text-align":"center"}},et={class:"text-weight-medium text-primary"},st=t("img",{src:"/assets/images/emp.jpeg",width:"20",height:"50",style:{"margin-top":"8px"}},null,-1),at={class:"text-caption"},ot={__name:"MapView",props:["lat","lng","office","welcomeText"],setup(c){const{MAP_KEY:g}=X(),a=c,l=h(()=>({lat:Number(a==null?void 0:a.lat),lng:Number(a==null?void 0:a.lng)})),x=h(()=>({center:{lat:Number(a==null?void 0:a.office.lat),lng:Number(a==null?void 0:a.office.lng)},radius:Number(a==null?void 0:a.office.radius)}));return L(()=>{}),(k,b)=>(d(),_(f(J),{"api-key":f(g),style:{width:"100%",height:"550px"},center:k.infoPosition,zoom:15},{default:n(()=>[e(f(K),{options:{position:l.value,anchorPoint:"BOTTOM_CENTER"}},{default:n(()=>[t("div",tt,[t("div",et,i(c.welcomeText),1),st])]),_:1},8,["options"]),e(f(U),{options:{position:x.value.center}},{default:n(()=>{var p;return[t("div",at,i((p=c.office)==null?void 0:p.name),1)]}),_:1},8,["options"]),e(f(W),{options:x.value},null,8,["options"])]),_:1},8,["api-key","center"]))}},nt={class:"row q-col-gutter-sm"},lt={class:"col-xs-12 col-sm-4"},it={class:"column q-pa-xs q-ma-sm-lg bg-white shadow-default"},ct={class:"text-center"},dt={class:"text-weight-medium text-dark"},rt={class:"text-weight-medium text-grey-7 q-ma-none"},ut={class:"text-weight-medium text-grey-7 q-ma-none"},mt={class:"text-bold text-dark"},_t={class:"text-weight-medium text-grey-7 q-ma-none"},ft={class:"text-bold text-dark"},ht={class:"col-xs-12 col-sm-8 q-col-gutter-sm"},gt={class:"row q-col-gutter-sm"},xt={class:"col-xs-12 col-sm-6"},pt={class:"bg-secondary text-white q-pa-sm shadow-default"},vt={class:"flex justify-between items-center"},wt={class:"text-xl text-bold"},yt=t("div",{class:"text-md"},"This week: PRESENT",-1),kt={class:"col-xs-12 col-sm-6"},bt={class:"bg-warning text-white q-pa-sm shadow-default"},qt={class:"flex justify-between items-center"},Dt={class:"text-xl text-bold"},Qt=t("div",{class:"text-md"},"This week: LATE",-1),Mt={class:"col-xs-12"},Nt=t("div",{class:"q-pa-sm"},[t("div",{class:"text-lg text-bold text-dark"},"Weekly Attendances")],-1),$t={class:"flex justify-between items-center shadow-default q-mt-sm bg-white q-pa-sm"},Ct={class:"text-lg text-bold text-weight-medium"},Tt={class:"text-sm text-grey-7 text-weight-medium"},Ht=Object.assign({layout:R},{__name:"Dashboard",props:["user","weekly_attendances","current_sessions","office"],setup(c){const g=c,a=G(),l=A({lat:null,lng:null,openMap:!1});h(()=>y.formatDate(Date.now()));const x=o=>y.formatDate(o,"DD/MM/YYYY hh:mm a"),k=o=>y.formatDate(o,"DD/MM/YYYY"),b=o=>y.formatDate(o,"hh:mm a"),p=h(()=>g.weekly_attendances.reduce((o,r,v)=>{const u=r.type==="present"?1:0;return o+u},0)),O=h(()=>g.weekly_attendances.reduce((o,r,v)=>{const u=r.type==="late"?1:0;return o+u},0)),V=o=>{a.dialog({title:"Confirmation",message:"Do you want to sign out this session?",ok:"Yes",cancel:"No"}).onOk(()=>{F.delete(route("attendance.signout",o.id),{onStart:r=>a.loading.show(),onFinish:r=>a.loading.hide()})})},P=o=>{l.openMap=!0};return L(()=>{navigator.geolocation.getCurrentPosition(function(o){l.lat=o.coords.latitude,l.lng=o.coords.longitude})}),(o,r)=>(d(),_(H,{class:"container",padding:""},{default:n(()=>{var v,u,N;return[t("div",nt,[t("div",lt,[t("div",it,[t("div",ct,[e(B,{class:"text-capitalize",size:"32px",color:"orange"},{default:n(()=>{var s;return[m(i((s=c.user)==null?void 0:s.full_name[0]),1)]}),_:1}),t("div",dt,i((v=c.user)==null?void 0:v.full_name),1),t("div",rt,i((u=c.user)==null?void 0:u.designation),1),e(j,{class:"full-width"}),t("div",ut,[m("Latitude: "),t("span",mt,i(l==null?void 0:l.lat),1)]),t("div",_t,[m("Longitude:"),t("span",ft,i(l==null?void 0:l.lng),1)]),e(q,{onClick:P,color:"secondary","no-caps":"",flat:"",label:"View in Map"})]),((N=c.current_sessions)==null?void 0:N.length)>0?(d(),_(T,{key:0,class:"q-pa-none",separator:""},{default:n(()=>[e(Y,null,{default:n(()=>[e(w,null,{default:n(()=>[e(M,{class:"text-dark text-lg"},{default:n(()=>[m("Active Sessions")]),_:1})]),_:1})]),_:1}),(d(!0),D(C,null,$(c.current_sessions,s=>(d(),_(Y,{key:s.id,class:"q-px-xs"},{default:n(()=>[e(w,{avatar:""},{default:n(()=>[e(Q,{name:"error_outline",color:"warning"})]),_:1}),e(w,null,{default:n(()=>[e(M,null,{default:n(()=>[m(i(b(s==null?void 0:s.signin_at)),1)]),_:2},1024),e(M,{caption:""},{default:n(()=>[m(i(k(s==null?void 0:s.signin_at)),1)]),_:2},1024)]),_:2},1024),e(w,{side:""},{default:n(()=>[e(q,{onClick:S=>V(s),round:"",icon:"logout",flat:""},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):z("",!0)]),e(Z,{class:"full-width"})]),t("div",ht,[t("div",gt,[t("div",xt,[t("div",pt,[t("div",vt,[t("div",wt,i(p.value),1),e(Q,{size:"26px",name:"person_add_alt"})]),yt])]),t("div",kt,[t("div",bt,[t("div",qt,[t("div",Dt,i(O.value),1),e(Q,{size:"26px",name:"o_person_remove"})]),Qt])])]),t("div",Mt,[Nt,e(T,null,{default:n(()=>[(d(!0),D(C,null,$(c.weekly_attendances,s=>(d(),D("div",$t,[t("div",null,[t("div",Ct,i(b(s.signin_at)),1),t("div",Tt,i(x(s==null?void 0:s.signin_at)),1)]),t("div",null,[s.type==="late"?(d(),_(E,{key:0,square:"","text-color":"white",color:"warning",label:"Late"})):(d(),_(E,{key:1,square:"","text-color":"white",color:"positive",label:"Present"}))]),t("div",null,[e(q,{onClick:S=>o.$inertia.get(o.route("attendance.show",s.id)),round:"",flat:"",icon:"o_chevron_right"},null,8,["onClick"])])]))),256))]),_:1})])])]),e(I,{modelValue:l.openMap,"onUpdate:modelValue":r[0]||(r[0]=s=>l.openMap=s)},{default:n(()=>[e(ot,{welcomeText:"Hello i am here",lat:l.lat,lng:l.lng,office:c.office},null,8,["lat","lng","office"])]),_:1},8,["modelValue"])]}),_:1}))}});export{Ht as default};
